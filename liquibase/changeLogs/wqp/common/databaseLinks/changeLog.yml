databaseChangeLog:
  - preConditions:
    - dbms:
        type: postgresql

  - changeSet:
      author: drsteini
      id: "create.database.link.wqp_core_dbdw.er.usgs.gov"
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - sqlCheck:
            expectedResult: 0
            sql: select count(*) from user_objects where object_name = 'WQP_CORE_DBDW.ER.USGS.GOV' and object_type = 'DATABASE LINK';
      changes:
        - sql: create database link wqp_core_dbdw.er.usgs.gov connect to wqp_core identified by "${wqp_core_dbdw_pwd}" using 'dbdw.er.usgs.gov';
        - rollback: drop database link wqp_core_dbdw.er.usgs.gov;

  - changeSet:
      author: drsteini
      id: "create.database.link.nemi.er.usgs.gov"
      preConditions:
        - onFail: MARK_RAN
        - onError: HALT
        - sqlCheck:
            expectedResult: 0
            sql: select count(*) from user_objects where object_name = 'NEMI.ER.USGS.GOV' and object_type = 'DATABASE LINK';
      changes:
        - sql: create database link nemi.er.usgs.gov connect to nemi_data identified by "${nemi_data_pwd}" using 'dbtrans.er.usgs.gov';
        - rollback: drop database link nemi.er.usgs.gov;
